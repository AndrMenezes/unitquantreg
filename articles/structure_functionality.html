<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="unitquantreg">
<title>Structure and functionality • unitquantreg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Structure and functionality">
<meta property="og:description" content="unitquantreg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-209203401-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-209203401-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">unitquantreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/unitquantreg.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/structure_functionality.html">Structure and functionality</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AndrMenezes/unitquantreg/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="structure_functionality_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Structure and functionality</h1>
                        <h4 data-toc-skip class="author">André Menezes</h4>
            
            <h4 data-toc-skip class="date">Last compiled on 2022-09-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/AndrMenezes/unitquantreg/blob/HEAD/vignettes/structure_functionality.Rmd" class="external-link"><code>vignettes/structure_functionality.Rmd</code></a></small>
      <div class="d-none name"><code>structure_functionality.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>unitquantreg</code> R package provide efficient tools for estimation and inference in parametric quantile regression models for bounded data.</p>
<p>The current version of <code>unitquantreg</code> has 11 probability distributions available for user choice. The Table above lists the families of distributions, their abbreviations and the paper reference.</p>
<table class="table">
<caption>Available families of distributions their abbreviations and reference.</caption>
<thead><tr class="header">
<th align="left">Family</th>
<th align="left">Abbreviation</th>
<th align="left">Reference</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">arc-secant hyperbolic Weibull</td>
<td align="left">ashw</td>
<td align="left"><a href="https://www.tandfonline.com/doi/full/10.1080/02664763.2021.1981834" class="external-link">Korkmaz et al. (2021)</a></td>
</tr>
<tr class="even">
<td align="left">Johnson-SB</td>
<td align="left">johnsonsb</td>
<td align="left"><a href="https://www.jstor.org/stable/2332539" class="external-link">Johnson (1949)</a></td>
</tr>
<tr class="odd">
<td align="left">Kumaraswamy</td>
<td align="left">kum</td>
<td align="left"><a href="https://www.sciencedirect.com/science/article/abs/pii/0022169480900360" class="external-link">Kumaraswamy, (1980)</a></td>
</tr>
<tr class="even">
<td align="left">log-extended Exponential-Geometric</td>
<td align="left">leeg</td>
<td align="left"><a href="https://doi.org/10.57805/revstat.v18i4.309" class="external-link">Jodrá and Jiménez-Gamero (2020)</a></td>
</tr>
<tr class="odd">
<td align="left">unit-Birnbaum-Saunders</td>
<td align="left">ubs</td>
<td align="left"><a href="https://www.mdpi.com/2073-8994/13/4/682" class="external-link">Mazucheli, et al. (2021)</a></td>
</tr>
<tr class="even">
<td align="left">unit-Burr-XII</td>
<td align="left">uburrxii</td>
<td align="left"><a href="https://link.springer.com/article/10.1007/s40314-021-01418-5" class="external-link">Korkmaz and Chesneau (2021)</a></td>
</tr>
<tr class="odd">
<td align="left">unit-Chen</td>
<td align="left">uchen</td>
<td align="left"><a href="https://doi.org/10.1515/ms-2022-0052" class="external-link">Korkmaz, et al. (2020)</a></td>
</tr>
<tr class="even">
<td align="left">unit-Generalized Half-Normal-E</td>
<td align="left">ughne</td>
<td align="left"><a href="https://www.scientificbulletin.upb.ro/rev_docs_arhiva/full6b9_464742.pdf" class="external-link">Korkmaz MÇ (2020)</a></td>
</tr>
<tr class="odd">
<td align="left">unit-Generalized Half-Normal-X</td>
<td align="left">ughnx</td>
<td align="left">New</td>
</tr>
<tr class="even">
<td align="left">unit-Gompertz</td>
<td align="left">ugompertz</td>
<td align="left"><a href="https://rivista-statistica.unibo.it/article/view/8497" class="external-link">Mazucheli et al. (2019)</a></td>
</tr>
<tr class="odd">
<td align="left">unit-Gumbel</td>
<td align="left">ugumbel</td>
<td align="left">New</td>
</tr>
<tr class="even">
<td align="left">unit-Logistic</td>
<td align="left">ulogistic</td>
<td align="left"><a href="https://www.jstor.org/stable/2335422" class="external-link">Tadikamalla and Johnson (1982)</a></td>
</tr>
<tr class="odd">
<td align="left">unit-Weibull</td>
<td align="left">uweibull</td>
<td align="left"><a href="http://japs.isoss.net/13(2)1%2011046.pdf" class="external-link">Mazucheli, et al. (2018)</a></td>
</tr>
</tbody>
</table>
<p>The [<code>dpqr</code>]’s functions of the distributions are vectorized and implemented in <code>C++</code>. The log likelihood, score and hessian functions are also implemented in <code>C++</code> in order to guarantee more computational efficiency.</p>
<p>The parameter estimation and inference are performed under the frequentist paradigm. Maximization of the log-likelihood function is done by optimization techniques available in the <code>R</code> through the <a href="https://CRAN.R-project.org/package=optimx" class="external-link"><code>optimx</code></a> package, which is a general-purpose optimization wrapper function that allows the use of several <code>R</code> tools for optimization, including the existing <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim()</a></code> function. To achieve quick and better convergence the analytical score function is use during the maximization. Also, standard errors of parameter estimates are computed using the analytical hessian matrix.</p>
</div>
<div class="section level2">
<h2 id="structure">Structure<a class="anchor" aria-label="anchor" href="#structure"></a>
</h2>
<p>The <code>unitquantreg</code> package is built around the <code><a href="../reference/unitquantreg.html">unitquantreg()</a></code> function which perform the fit of parametric quantile regression models via likelihood method. The <code><a href="../reference/unitquantreg.html">unitquantreg()</a></code> function has standard arguments as <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code> function, and they are as follows:</p>
<pre><code><span><span class="co">#&gt; function (formula, data, subset, na.action, tau, family, link = c("logit", </span></span>
<span><span class="co">#&gt;     "probit", "cloglog", "cauchit"), link.theta = c("identity", </span></span>
<span><span class="co">#&gt;     "log", "sqrt"), start = NULL, control = unitquantreg.control(), </span></span>
<span><span class="co">#&gt;     model = TRUE, x = FALSE, y = TRUE) </span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre>
<p>The <code>formula</code> argument use the concept of <a href="https://CRAN.R-project.org/package=Formula" class="external-link"><code>Formula</code></a> package allows multiple parts on the right-hand side, which indicates regression structure for the quantile and shape parameter of the distribution. For instance, <code>formula = y ~ x1 | z1</code> means the following regression structure</p>
<p><span class="math display">\[
g_1(\mu) = \beta_0 + \beta_1\,x_1 \quad \textrm{and} \quad g_2(\theta) = \gamma_0 + \gamma_1\,z_1
\]</span> where <span class="math inline">\(\mu\)</span> indicates the quantile of order <span class="math inline">\(\tau\)</span> and <span class="math inline">\(\theta\)</span> is the shape parameter.</p>
<p>The <code>tau</code> argument indicates the quantile(s) to be estimated, being possible to specify a vector of quantiles. <code>family</code> argument specify the distribution family using the abbreviation of <code>dpqr</code> functions, listed in Table above.</p>
<p>The <code>control</code> argument controls the fitting process through the <code><a href="../reference/unitquantreg.control.html">unitquantreg.control()</a></code> function which returned a <code>list</code> and the default values are:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="../reference/unitquantreg.control.html">unitquantreg.control</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 method                hessian               gradient </span></span>
<span><span class="co">#&gt;                 "BFGS"                "FALSE"                 "TRUE" </span></span>
<span><span class="co">#&gt;                  maxit                 reltol                  factr </span></span>
<span><span class="co">#&gt;                 "5000" "1.49011611938477e-08"                "1e+07" </span></span>
<span><span class="co">#&gt;                  trace                 dowarn             starttests </span></span>
<span><span class="co">#&gt;                    "0"                "FALSE"                "FALSE" </span></span>
<span><span class="co">#&gt;                fnscale </span></span>
<span><span class="co">#&gt;                    "1"</span></span></code></pre></div>
<p>The two most important arguments are <code>hessian</code> and <code>gradient</code> which tell the <code><a href="https://rdrr.io/pkg/optimx/man/optimx.html" class="external-link">optimx::optimx()</a></code> whether it should use the numerical hessian matrix and the analytical score vector, respectively. That is, if <code>hessian = TRUE</code>, then the standard errors are computed using the numerical hessian matrix. For detailed description of other arguments see the package documentation.</p>
<div class="section level3">
<h3 id="object-oriented-programming">Object-oriented programming<a class="anchor" aria-label="anchor" href="#object-oriented-programming"></a>
</h3>
<p>The <code>unitquanreg()</code> function returns an object of class <code>unitquanreg</code> if the argument <code>tau</code> is scalar or <code>unitquanregs</code> if <code>tau</code> is a vector. The currently methods implemented for <code>unitquantreg</code> objects are:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"unitquantreg"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] coef         confint      fitted       hnp          logLik      </span></span>
<span><span class="co">#&gt;  [6] model.frame  model.matrix plot         predict      print       </span></span>
<span><span class="co">#&gt; [11] residuals    summary      terms        update       vcov        </span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
<p>And for the <code>unitquantregs</code> objects are</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"unitquantregs"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] plot    print   summary</span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
<p>It is important to mention that the <code>unitquantregs</code> objects consists of a list with <code>unitquantreg</code> objects for according to the vector of <code>tau</code>.</p>
<p>Furthermore, the package provide functions designated for model comparison between <code>uniquantreg</code> objects. Particularly,</p>
<ul>
<li><p><code><a href="../reference/likelihood_stats.html">likelihood_stats()</a></code> function computes likelihood-based statistics (Neg2LogLike, AIC, BIC and HQIC),</p></li>
<li><p><code><a href="../reference/vuong.test.html">vuong.test()</a></code> function performs Vuong test between two fitted <strong>non nested</strong> models,</p></li>
<li><p><code><a href="../reference/pairwise.vuong.test.html">pairwise.vuong.test()</a></code> function performs pairwise Vuong test with adjusted p-value according to <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">stats::p.adjust.methods</a></code> between fitted models</p></li>
</ul>
<p>Finally, <code>uniquantreg</code> objects also permits use the inference methods functions <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">lmtest::coeftest()</a></code>, <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">lmtest::coefci</a></code>, <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">lmtest::coefci</a></code>, <code><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html" class="external-link">lmtest::waldtest</a></code> and <code><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html" class="external-link">lmtest::lrtest</a></code> implemented in <a href="https://CRAN.R-project.org/package=lmtest" class="external-link"><code>lmtest</code></a> to perform hypothesis test, confidence intervals for <strong>nested models</strong>.</p>
<p>Next, a detailed account of the usage of all these functions is provided.</p>
</div>
</div>
<div class="section level2">
<h2 id="functionality">Functionality<a class="anchor" aria-label="anchor" href="#functionality"></a>
</h2>
<p>As in <a href="https://www.tandfonline.com/doi/abs/10.1080/02664763.2019.1657813?journalCode=cjas20" class="external-link">Mazucheli et al. (2020)</a> consider the data set related to the access of people in households with piped water supply in the cities of Brazil from the Southeast and Northeast regions. The response variable <code>phpws</code> is the proportion of households with piped water supply. The covariates are:</p>
<ul>
<li><p><code>mhdi</code>: human development index.</p></li>
<li><p><code>incpc</code>: per capita income.</p></li>
<li><p><code>region</code>: 0 for southeast, 1 for northeast.</p></li>
<li><p><code>pop</code>: population.</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">water</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">water</span><span class="op">)</span></span>
<span><span class="co">#&gt;    phpws  mhdi  incpc region    pop</span></span>
<span><span class="co">#&gt; 1 0.8957 0.672 438.56      1 104047</span></span>
<span><span class="co">#&gt; 2 0.6777 0.529 149.78      1   5905</span></span>
<span><span class="co">#&gt; 3 0.8673 0.500 172.55      1  11581</span></span>
<span><span class="co">#&gt; 4 0.7363 0.573 209.27      1  21851</span></span>
<span><span class="co">#&gt; 5 0.7726 0.513 179.92      1  23952</span></span>
<span><span class="co">#&gt; 6 0.8824 0.549 164.24      1  11063</span></span></code></pre></div>
<p>Assuming the following regression structure for the parameters: <span class="math display">\[
\textrm{logit}(\mu_i) = \beta_0 + \beta_1 \texttt{mhdi}_{i1} + \beta_2 \texttt{incp}_{i2} +
\beta_3 \texttt{region}_{i3} + \beta_4 \log\left(\texttt{pop}_{i4}\right),
\]</span> and <span class="math display">\[
\log(\theta_i) = \gamma_0.
\]</span> for <span class="math inline">\(i = 1, \ldots, 3457\)</span>.</p>
<div class="section level3">
<h3 id="model-fitting">Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h3>
<p>For <span class="math inline">\(\tau = 0.5\)</span>, that is, the median regression model we fitted for all families of distributions as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lt_families</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"unit-Weibull"</span> <span class="op">=</span> <span class="st">"uweibull"</span>,</span>
<span>                    <span class="st">"Kumaraswamy"</span> <span class="op">=</span> <span class="st">"kum"</span>,</span>
<span>                    <span class="st">"unit-Logistic"</span> <span class="op">=</span> <span class="st">"ulogistic"</span>,</span>
<span>                    <span class="st">"unit-Birnbaum-Saunders"</span> <span class="op">=</span> <span class="st">"ubs"</span>,</span>
<span>                    <span class="st">"log-extended Exponential-Geometric"</span> <span class="op">=</span> <span class="st">"leeg"</span>,</span>
<span>                    <span class="st">"unit-Chen"</span> <span class="op">=</span> <span class="st">"uchen"</span>,</span>
<span>                    <span class="st">"unit-Generalized Half-Normal-E"</span> <span class="op">=</span> <span class="st">"ughne"</span>,</span>
<span>                    <span class="st">"unit-Generalized Half-Normal-X"</span> <span class="op">=</span> <span class="st">"ughnx"</span>,</span>
<span>                    <span class="st">"unit-Gompertz"</span> <span class="op">=</span> <span class="st">"ugompertz"</span>,</span>
<span>                    <span class="st">"Johnson-SB"</span> <span class="op">=</span> <span class="st">"johnsonsb"</span>,</span>
<span>                    <span class="st">"unit-Burr-XII"</span> <span class="op">=</span> <span class="st">"uburrxii"</span>,</span>
<span>                    <span class="st">"arc-secant hyperbolic Weibull"</span> <span class="op">=</span> <span class="st">"ashw"</span>,</span>
<span>                    <span class="st">"unit-Gumbel"</span> <span class="op">=</span> <span class="st">"ugumbel"</span><span class="op">)</span></span>
<span><span class="va">lt_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">lt_families</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fam</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/unitquantreg.html">unitquantreg</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">phpws</span> <span class="op">~</span> <span class="va">mhdi</span> <span class="op">+</span> <span class="va">incpc</span> <span class="op">+</span> <span class="va">region</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">water</span>,</span>
<span>               tau <span class="op">=</span> <span class="fl">0.5</span>, family <span class="op">=</span> <span class="va">fam</span>, link <span class="op">=</span> <span class="st">"logit"</span>, link.theta <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">lt_fits</span>, <span class="va">coef</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                    (Intercept)      mhdi         incpc</span></span>
<span><span class="co">#&gt; unit-Weibull                         -6.514485 11.826177  2.600473e-04</span></span>
<span><span class="co">#&gt; Kumaraswamy                          -1.625951  4.843166  2.111029e-03</span></span>
<span><span class="co">#&gt; unit-Logistic                        -5.365469 10.508100  1.559636e-03</span></span>
<span><span class="co">#&gt; unit-Birnbaum-Saunders               -6.556648 13.723681  6.499360e-04</span></span>
<span><span class="co">#&gt; log-extended Exponential-Geometric   -4.712735  9.142144  1.928040e-03</span></span>
<span><span class="co">#&gt; unit-Chen                            -8.098012 13.560938 -6.162645e-05</span></span>
<span><span class="co">#&gt; unit-Generalized Half-Normal-E       -6.598061 11.731146 -1.037014e-04</span></span>
<span><span class="co">#&gt; unit-Generalized Half-Normal-X       -5.035562 13.186081  1.580614e-03</span></span>
<span><span class="co">#&gt; unit-Gompertz                        -6.260194 11.719934  4.103341e-04</span></span>
<span><span class="co">#&gt; Johnson-SB                           -5.993763 11.803290  1.144566e-03</span></span>
<span><span class="co">#&gt; unit-Burr-XII                        -5.811837 11.043123  3.777215e-04</span></span>
<span><span class="co">#&gt; arc-secant hyperbolic Weibull        -7.363838 12.705584  7.957473e-05</span></span>
<span><span class="co">#&gt; unit-Gumbel                          -9.338592 14.990026 -5.503130e-04</span></span>
<span><span class="co">#&gt;                                         region    log(pop)  log(theta)</span></span>
<span><span class="co">#&gt; unit-Weibull                       -0.26990871  0.10546762  0.17249694</span></span>
<span><span class="co">#&gt; Kumaraswamy                        -0.07860323 -0.04727081  1.75778137</span></span>
<span><span class="co">#&gt; unit-Logistic                      -0.15826000  0.01773368  0.63005907</span></span>
<span><span class="co">#&gt; unit-Birnbaum-Saunders             -0.18081222 -0.02300195  0.00832919</span></span>
<span><span class="co">#&gt; log-extended Exponential-Geometric -0.18882479  0.02252007  1.68797084</span></span>
<span><span class="co">#&gt; unit-Chen                          -0.48153890  0.19218762 -0.25568492</span></span>
<span><span class="co">#&gt; unit-Generalized Half-Normal-E     -0.37220694  0.14224250 -0.18418543</span></span>
<span><span class="co">#&gt; unit-Generalized Half-Normal-X     -0.16993805 -0.18341181 -0.38141377</span></span>
<span><span class="co">#&gt; unit-Gompertz                      -0.23932329  0.09146941 -5.42477111</span></span>
<span><span class="co">#&gt; Johnson-SB                         -0.19500756  0.01823070  0.01748328</span></span>
<span><span class="co">#&gt; unit-Burr-XII                      -0.19140000  0.07565710  0.28322367</span></span>
<span><span class="co">#&gt; arc-secant hyperbolic Weibull      -0.38168564  0.14972053  0.72098495</span></span>
<span><span class="co">#&gt; unit-Gumbel                        -0.62080389  0.25058612 -0.26073820</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h3>
<p>Let’s check the likelihood-based statistics of fit</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/likelihood_stats.html">likelihood_stats</a></span><span class="op">(</span>lt <span class="op">=</span> <span class="va">lt_fits</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Likelihood-based statistics of fit for unit quantile regression models </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  likelihood_stats(lt = lt_fits)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                    Neg2LogLike AIC       BIC       HQIC     </span></span>
<span><span class="co">#&gt; unit-Logistic                      -8443.029   -8431.029 -8394.140 -8417.855</span></span>
<span><span class="co">#&gt; Johnson-SB                         -8238.405   -8226.405 -8189.516 -8213.232</span></span>
<span><span class="co">#&gt; unit-Burr-XII                      -8096.114   -8084.114 -8047.225 -8070.941</span></span>
<span><span class="co">#&gt; unit-Weibull                       -7994.077   -7982.077 -7945.188 -7968.903</span></span>
<span><span class="co">#&gt; unit-Birnbaum-Saunders             -7955.990   -7943.990 -7907.101 -7930.817</span></span>
<span><span class="co">#&gt; unit-Gompertz                      -7808.838   -7796.838 -7759.949 -7783.664</span></span>
<span><span class="co">#&gt; arc-secant hyperbolic Weibull      -7679.482   -7667.482 -7630.593 -7654.308</span></span>
<span><span class="co">#&gt; log-extended Exponential-Geometric -7677.034   -7665.034 -7628.145 -7651.860</span></span>
<span><span class="co">#&gt; unit-Generalized Half-Normal-E     -7496.966   -7484.966 -7448.077 -7471.792</span></span>
<span><span class="co">#&gt; Kumaraswamy                        -7188.498   -7176.498 -7139.609 -7163.324</span></span>
<span><span class="co">#&gt; unit-Chen                          -7016.542   -7004.542 -6967.653 -6991.368</span></span>
<span><span class="co">#&gt; unit-Generalized Half-Normal-X     -6965.962   -6953.962 -6917.073 -6940.789</span></span>
<span><span class="co">#&gt; unit-Gumbel                        -6531.775   -6519.775 -6482.886 -6506.602</span></span></code></pre></div>
<p>According to the statistics the unit-Logistic, Johnson-SB, unit-Burr-XII and unit-Weibull were the best models. Now, let’s perform the pairwise <a href="https://en.wikipedia.org/wiki/Vuong%27s_closeness_test" class="external-link">vuong test</a> to check if there is statistical significant difference between the four models.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lt_chosen</span> <span class="op">&lt;-</span> <span class="va">lt_fits</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unit-Logistic"</span>, <span class="st">"Johnson-SB"</span>, <span class="st">"unit-Burr-XII"</span>, <span class="st">"unit-Weibull"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/pairwise.vuong.test.html">pairwise.vuong.test</a></span><span class="op">(</span>lt <span class="op">=</span> <span class="va">lt_chosen</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pairwise comparisons using Vuong likelihood ratio test for non-nested models </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  unitquantreg(formula = phpws ~ mhdi + incpc + region + log(pop), </span></span>
<span><span class="co">#&gt;     data = water, tau = 0.5, family = fam, link = "logit", link.theta = "log") </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               unit-Logistic Johnson-SB unit-Burr-XII</span></span>
<span><span class="co">#&gt; Johnson-SB    0.00031       -          -            </span></span>
<span><span class="co">#&gt; unit-Burr-XII 3.9e-07       0.09659    -            </span></span>
<span><span class="co">#&gt; unit-Weibull  8.8e-11       0.00013    0.04868      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P value adjustment method: holm</span></span></code></pre></div>
<p>The adjusted p-values of pairwise vuong tests shows that there is a large statistical significance difference between the models. In particular, the pairwise comparison between unit-Logistic and the other models provide a smaller p-values, indicating that the unit-Logistic median regression model is the most suitable model for this data set comparing to the others families of distributions.</p>
</div>
<div class="section level3">
<h3 id="diagnostic-analysis">Diagnostic analysis<a class="anchor" aria-label="anchor" href="#diagnostic-analysis"></a>
</h3>
<p>It is possible to check model assumptions from diagnostic plots using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function method for <code>unitquantreg</code> objects. The <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals()</a></code> method provides <code>quantile</code>, <code>cox-snell</code>, <code>working</code> and <code>partial</code> residuals type. The randomzide quantile residuals is the default choice of <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lt_fits</span><span class="op">[[</span><span class="st">"unit-Logistic"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="structure_functionality_files/figure-html/plots-diagnostic-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
<p>Plots of the residuals against the fitted linear predictor and the residuals against indices of observations are the tools for diagnostic analysis to check the structural form of the model. Two features of the plots are important:</p>
<ul>
<li><p>Trends: Any trends appearing in these plots indicate that the systematic component can be improved. This could mean changing the link function, adding extra explanatory variables, or transforming the explanatory variables.</p></li>
<li><p>Constant variation: If the random component is correct then the variance of the points is approximately constant.</p></li>
</ul>
<p>Working residuals versus linear predictor is used to check possible misspecification of link function and Half-normal plot of residuals to check distribution assumption.</p>
<p>Another best practice in diagnostic analysis is to inspect the (Half)-Normal plots with simulated envelope for several quantile value. This is done to obtain a more robust evaluation of the model assumptions. Thus, let’s fit the unit-Logistic quantile regression model for various quantiles.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">fits_ulogistic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unitquantreg.html">unitquantreg</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">phpws</span> <span class="op">~</span> <span class="va">mhdi</span> <span class="op">+</span> <span class="va">incpc</span> <span class="op">+</span> <span class="va">region</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span>,</span>
<span>                                 data <span class="op">=</span> <span class="va">water</span>, tau <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">49</span><span class="op">/</span><span class="fl">50</span>,</span>
<span>                                 family <span class="op">=</span> <span class="st">"ulogistic"</span>, link <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>                                 link.theta <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  11.880   0.000  11.881</span></span></code></pre></div>
<p>Now we can check the (Half)-Normal plots using the output of <code><a href="../reference/hnp.html">hnp()</a></code> method.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">get_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hnp.html">hnp</a></span><span class="op">(</span><span class="va">obj</span>, halfnormal <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, nsim <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"cbind"</span>, <span class="va">tmp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">tmp</span><span class="op">$</span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">obj</span><span class="op">$</span><span class="va">tau</span><span class="op">)</span></span>
<span>  <span class="va">tmp</span></span>
<span><span class="op">}</span></span>
<span><span class="va">chosen_taus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.02"</span>, <span class="st">"0.5"</span>, <span class="st">"0.98"</span><span class="op">)</span></span>
<span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">fits_ulogistic</span><span class="op">[</span><span class="va">chosen_taus</span><span class="op">]</span>, <span class="va">get_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_plot</span><span class="op">$</span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">tau</span><span class="op">)</span>, <span class="st">" == "</span>, <span class="va">df_plot</span><span class="op">$</span><span class="va">tau</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">teo</span>, y<span class="op">=</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">tau</span>, labeller <span class="op">=</span> <span class="va">label_parsed</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">1.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">median</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lower</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#0080ff"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"#0080ff"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Theoretical quantiles"</span>, y <span class="op">=</span> <span class="st">"Randomized quantile residuals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, family <span class="op">=</span> <span class="st">"Palatino"</span><span class="op">)</span>, </span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="structure_functionality_files/figure-html/plots-hnp-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="inference-results">Inference results<a class="anchor" aria-label="anchor" href="#inference-results"></a>
</h3>
<p>Inference results about the parameter estimates can be accessed through the <code>summary</code> method. For instance,</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lt_fits</span><span class="op">[[</span><span class="st">"unit-Logistic"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wald-tests for unit-Logistic quantile regression model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  unitquantreg(formula = phpws ~ mhdi + incpc + region + log(pop), </span></span>
<span><span class="co">#&gt;     data = water, tau = 0.5, family = fam, link = "logit", link.theta = "log")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mu coefficients: (quantile model with logit link and tau = 0.5): </span></span>
<span><span class="co">#&gt;               Estimate Std. Error Z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept) -5.3654690  0.3373263 -15.906  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; mhdi        10.5080995  0.5717793  18.378  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; incpc        0.0015596  0.0001706   9.140  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; region      -0.1582600  0.0488825  -3.238  0.00121 ** </span></span>
<span><span class="co">#&gt; log(pop)     0.0177337  0.0167306   1.060  0.28917    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model with constant shape:</span></span>
<span><span class="co">#&gt;            Estimate Std. Error Z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; log(theta)  0.63006    0.01421   44.35   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual degrees of freedom: 3451</span></span>
<span><span class="co">#&gt; Log-likelihood: 4221.514</span></span>
<span><span class="co">#&gt; Number of iterations: 65</span></span></code></pre></div>
<p>For <code>unitquantregs</code> objects the <code>plot</code> method provide a convenience to check the significance as well as the effect of estimate along the specify quantile value.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fits_ulogistic</span>, which <span class="op">=</span> <span class="st">"coef"</span>, mean_effect <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="structure_functionality_files/figure-html/plot-ulogistic-1.png" width="1152" style="display: block; margin: auto;"></p>
<p>Curiously, the unit-Logistic quantile regression models capture constant effect for all covariates along the different quantiles. In contrast, the unit-Weibull model (the fourth best model) found a decrease effect of <code>mhdi</code> covaraite on the response as the quantile increases and increase effects of <code>incpc</code> and <code>region</code> on the response variable as the quantile increases.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">fits_uweibull</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/unitquantreg.html">unitquantreg</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">phpws</span> <span class="op">~</span> <span class="va">mhdi</span> <span class="op">+</span> <span class="va">incpc</span> <span class="op">+</span> <span class="va">region</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span>,</span>
<span>                                 data <span class="op">=</span> <span class="va">water</span>, tau <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">49</span><span class="op">/</span><span class="fl">50</span>,</span>
<span>                                 family <span class="op">=</span> <span class="st">"uweibull"</span>, link <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>                                 link.theta <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  13.070   0.004  13.076</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fits_uweibull</span>, which <span class="op">=</span> <span class="st">"coef"</span><span class="op">)</span></span></code></pre></div>
<p><img src="structure_functionality_files/figure-html/fits-uweibull-1.png" width="1152" style="display: block; margin: auto;"></p>
<p>Using the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method with argument <code>which = "conddist"</code> for <code>unitquantregs</code> objects it is possible to estimate and visualize the conditional distribution of a response variable at different values of covariates. For instance,</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lt_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mhdi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.7</span><span class="op">)</span>, incpc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">water</span><span class="op">$</span><span class="va">incpc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">water</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fits_ulogistic</span>, which <span class="op">=</span> <span class="st">"conddist"</span>, at_obs <span class="op">=</span> <span class="va">lt_data</span>, at_avg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     dist_type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="structure_functionality_files/figure-html/plot-conddis-1.png" width="1152" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fits_ulogistic</span>, which <span class="op">=</span> <span class="st">"conddist"</span>, at_obs <span class="op">=</span> <span class="va">lt_data</span>, at_avg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     dist_type <span class="op">=</span> <span class="st">"cdf"</span><span class="op">)</span></span></code></pre></div>
<p><img src="structure_functionality_files/figure-html/plot-conddis-2.png" width="1152" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 20.04.5 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ggplot2_3.3.6      unitquantreg_0.0.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] xfun_0.33           bslib_0.4.0         purrr_0.3.4        </span></span>
<span><span class="co">#&gt;  [4] splines_4.2.1       lattice_0.20-45     colorspace_2.0-3   </span></span>
<span><span class="co">#&gt;  [7] vctrs_0.4.1         htmltools_0.5.3     yaml_2.3.5         </span></span>
<span><span class="co">#&gt; [10] utf8_1.2.2          survival_3.4-0      rlang_1.0.5        </span></span>
<span><span class="co">#&gt; [13] pkgdown_2.0.6       jquerylib_0.1.4     pillar_1.8.1       </span></span>
<span><span class="co">#&gt; [16] withr_2.5.0         glue_1.6.2          optimx_2022-4.30   </span></span>
<span><span class="co">#&gt; [19] lifecycle_1.0.2     stringr_1.4.1       MatrixModels_0.5-1 </span></span>
<span><span class="co">#&gt; [22] munsell_0.5.0       gtable_0.3.1        ragg_1.2.2         </span></span>
<span><span class="co">#&gt; [25] codetools_0.2-18    memoise_2.0.1       evaluate_0.16      </span></span>
<span><span class="co">#&gt; [28] knitr_1.40          fastmap_1.1.0       SparseM_1.81       </span></span>
<span><span class="co">#&gt; [31] quantreg_5.94       fansi_1.0.3         highr_0.9          </span></span>
<span><span class="co">#&gt; [34] Rcpp_1.0.9          scales_1.2.1        cachem_1.0.6       </span></span>
<span><span class="co">#&gt; [37] desc_1.4.2          jsonlite_1.8.0      farver_2.1.1       </span></span>
<span><span class="co">#&gt; [40] systemfonts_1.0.4   fs_1.5.2            textshaping_0.3.6  </span></span>
<span><span class="co">#&gt; [43] digest_0.6.29       stringi_1.7.8       numDeriv_2016.8-1.1</span></span>
<span><span class="co">#&gt; [46] grid_4.2.1          rprojroot_2.0.3     cli_3.4.0          </span></span>
<span><span class="co">#&gt; [49] tools_4.2.1         magrittr_2.0.3      sass_0.4.2         </span></span>
<span><span class="co">#&gt; [52] tibble_3.1.8        Formula_1.2-4       pkgconfig_2.0.3    </span></span>
<span><span class="co">#&gt; [55] MASS_7.3-58.1       Matrix_1.5-1        rmarkdown_2.16     </span></span>
<span><span class="co">#&gt; [58] R6_2.5.1            compiler_4.2.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://andrmenezes.github.io" class="external-link">André F. B. Menezes</a>, <a href="https://scholar.google.com/citations?hl=en&amp;user=JAGnl3sAAAAJ&amp;view_op=list_works&amp;sortby=pubdate" class="external-link">Josmar Mazucheli</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
